{"version":3,"file":"stanz.min.mjs","sources":["../ofa-error/main.js","../src/public.mjs","../src/watch.mjs","../src/accessor.mjs","../src/array.mjs","../src/main.mjs","../src/base.mjs"],"sourcesContent":["// const error_origin = \"http://127.0.0.1:5793/errors\";\nconst error_origin = \"https://ofajs.github.io/ofa-errors/errors\";\n\n// 存放错误信息的数据对象\nconst errors = {};\n\nif (globalThis.navigator && navigator.language) {\n  let langFirst = navigator.language.toLowerCase().split(\"-\")[0];\n\n  if (langFirst === \"zh\" && navigator.language.toLowerCase() !== \"zh-cn\") {\n    langFirst = \"zhft\";\n  }\n\n  (async () => {\n    if (typeof localStorage !== \"undefined\") {\n      if (localStorage[\"ofa-errors\"]) {\n        const targetLangErrors = JSON.parse(localStorage[\"ofa-errors\"]);\n        Object.assign(errors, targetLangErrors);\n      }\n\n      const errCacheTime = localStorage[\"ofa-errors-time\"];\n\n      if (!errCacheTime || Date.now() > Number(errCacheTime) + 5 * 60 * 1000) {\n        const targetLangErrors = await fetch(\n          `${error_origin}/${langFirst}.json`\n        )\n          .then((e) => e.json())\n          .catch(() => null);\n\n        if (targetLangErrors) {\n          localStorage[\"ofa-errors\"] = JSON.stringify(targetLangErrors);\n          localStorage[\"ofa-errors-time\"] = Date.now();\n        } else {\n          targetLangErrors = await fetch(`${error_origin}/en.json`)\n            .then((e) => e.json())\n            .catch((error) => {\n              console.error(error);\n              return null;\n            });\n        }\n\n        Object.assign(errors, targetLangErrors);\n      }\n    }\n  })();\n}\n\nlet isSafari = false;\nif (globalThis.navigator) {\n  isSafari =\n    navigator.userAgent.includes(\"Safari\") &&\n    !navigator.userAgent.includes(\"Chrome\");\n}\n\n/**\n * 根据键、选项和错误对象生成错误对象。\n *\n * @param {string} key - 错误描述的键。\n * @param {Object} [options] - 映射相关值的选项对象。\n * @param {Error} [error] - 原始错误对象。\n * @returns {Error} 生成的错误对象。\n */\nexport const getErr = (key, options, error) => {\n  let desc = getErrDesc(key, options);\n\n  let errObj;\n  if (error) {\n    if (isSafari) {\n      desc += `\\nCaused by: ${error.toString()}\\n`;\n\n      if (error.stack) {\n        desc += `  ${error.stack.replace(/\\n/g, \"\\n    \")}`;\n      }\n    }\n    errObj = new Error(desc, { cause: error });\n  } else {\n    errObj = new Error(desc);\n  }\n  errObj.code = key;\n  return errObj;\n};\n\n/**\n * 根据键、选项生成错误描述\n *\n * @param {string} key - 错误描述的键。\n * @param {Object} [options] - 映射相关值的选项对象。\n * @returns {string} 生成的错误描述。\n */\nexport const getErrDesc = (key, options) => {\n  if (!errors[key]) {\n    return `Error code: \"${key}\", please go to https://github.com/ofajs/ofa-errors to view the corresponding error information`;\n  }\n\n  let desc = errors[key];\n\n  // 映射相关值\n  if (options) {\n    for (let k in options) {\n      desc = desc.replace(new RegExp(`{${k}}`, \"g\"), options[k]);\n    }\n  }\n\n  return desc;\n};\n","import { getErr, getErrDesc } from \"../ofa-error/main.js\";\n\nexport const getRandomId = () => Math.random().toString(32).slice(2);\n\nconst objectToString = Object.prototype.toString;\nexport const getType = (value) =>\n  objectToString\n    .call(value)\n    .toLowerCase()\n    .replace(/(\\[object )|(])/g, \"\");\n\nexport const isObject = (obj) => {\n  const type = getType(obj);\n  return type === \"array\" || type === \"object\";\n};\n\n// export const isDebug = {\n//   value: null,\n// };\n\n// try {\n//   const fileUrl = import.meta.url;\n//   isDebug.value = fileUrl.includes(\"#debug\");\n// } catch (err) {\n//   isDebug.value = false;\n// }\n\n// const TICKERR = \"nexttick_thread_limit\";\n\nlet asyncsCounter = 0;\nlet afterTimer;\nconst tickSets = new Set();\nexport function nextTick(callback) {\n  clearTimeout(afterTimer);\n  afterTimer = setTimeout(() => {\n    asyncsCounter = 0;\n  });\n\n  // if (isDebug.value) {\n  Promise.resolve().then(() => {\n    asyncsCounter++;\n    if (asyncsCounter > 100000) {\n      const err = getErr(\"nexttick_thread_limit\");\n      console.warn(err, \"lastCall => \", callback);\n      throw err;\n    }\n\n    callback();\n  });\n  return;\n  // }\n\n  // const tickId = `t-${getRandomId()}`;\n  // tickSets.add(tickId);\n  // Promise.resolve().then(() => {\n  //   asyncsCounter++;\n  //   // console.log(\"asyncsCounter => \", asyncsCounter);\n  //   if (asyncsCounter > 50000) {\n  //     tickSets.clear();\n\n  //     const err = getErr(TICKERR);\n  //     console.warn(err, \"lastCall => \", callback);\n  //     throw err;\n  //   }\n  //   if (tickSets.has(tickId)) {\n  //     callback();\n  //     tickSets.delete(tickId);\n  //   }\n  // });\n  // return tickId;\n}\n\n// export const clearTick = (id) => tickSets.delete(id);\n\nexport function debounce(func, wait = 0) {\n  let timeout = null;\n  let hisArgs = [];\n\n  return function (...args) {\n    hisArgs.push(...args);\n\n    if (wait > 0) {\n      clearTimeout(timeout);\n      timeout = setTimeout(() => {\n        func.call(this, hisArgs);\n        hisArgs = [];\n        timeout = null;\n      }, wait);\n    } else {\n      if (timeout === null) {\n        timeout = 1;\n        nextTick(() => {\n          timeout = null;\n          const args = hisArgs.slice();\n          hisArgs = [];\n          func.call(this, args);\n        });\n      }\n    }\n  };\n}\n\n// Enhanced methods for extending objects\nexport const extend = (_this, proto, descriptor = {}) => {\n  [\n    ...Object.getOwnPropertyNames(proto),\n    ...Object.getOwnPropertySymbols(proto),\n  ].forEach((k) => {\n    const result = Object.getOwnPropertyDescriptor(proto, k);\n    const { configurable, enumerable, writable, get, set, value } = result;\n\n    if (\"value\" in result) {\n      if (_this.hasOwnProperty(k)) {\n        _this[k] = value;\n      } else {\n        Object.defineProperty(_this, k, {\n          enumerable,\n          configurable,\n          writable,\n          ...descriptor,\n          value,\n        });\n      }\n    } else {\n      Object.defineProperty(_this, k, {\n        enumerable,\n        configurable,\n        ...descriptor,\n        get,\n        set,\n      });\n    }\n  });\n\n  return _this;\n};\n\n// 检测 Proxy 是否被撤销的函数\nexport function dataRevoked(proxyToCheck) {\n  try {\n    // 尝试对 Proxy 做一个无害的操作，例如获取原型\n    Object.getPrototypeOf(proxyToCheck);\n    return false; // 如果没有抛出错误，则 Proxy 没有被撤销\n  } catch (error) {\n    if (error instanceof TypeError) {\n      return true; // 如果抛出了 TypeError，则 Proxy 已经被撤销\n    }\n    // throw error; // 抛出其他类型的错误\n    return false;\n  }\n}\n","import { getRandomId, debounce, dataRevoked } from \"./public.mjs\";\nimport { WATCHS } from \"./main.mjs\";\nimport { getErr } from \"../ofa-error/main.js\";\nconst { assign, freeze } = Object;\n\nclass Watcher {\n  constructor(opts) {\n    assign(this, opts);\n    freeze(this);\n  }\n\n  hasModified(k) {\n    if (this.type === \"array\") {\n      return this.path.includes(this.currentTarget.get(k));\n    }\n\n    const keys = k.split(\".\");\n\n    if (this.currentTarget === this.target && this.name === keys[0]) {\n      return true;\n    }\n\n    const modifieds = getModifieds(this, keys);\n\n    const positionIndex = modifieds.indexOf(this.target);\n    if (positionIndex > -1) {\n      const currentKeys = keys.slice(positionIndex + 1);\n\n      if (!currentKeys.length) {\n        // This is listening for changes in the child object itself\n        return true;\n      }\n\n      return this.name === currentKeys[0];\n    }\n\n    // Data belonging to the chain of change\n    return this.path.includes(this.currentTarget[k]);\n  }\n\n  hasReplaced(k) {\n    if (this.type !== \"set\") {\n      return false;\n    }\n\n    const keys = k.split(\".\");\n\n    if (this.target === this.currentTarget && this.name === keys[0]) {\n      return true;\n    }\n\n    const modifieds = getModifieds(this, keys);\n\n    const positionIndex = modifieds.indexOf(this.target);\n\n    if (positionIndex > -1) {\n      const currentKeys = keys.slice(positionIndex + 1);\n\n      return currentKeys[0] === this.name;\n    }\n\n    return false;\n  }\n}\n\nconst getModifieds = (_this, keys) => {\n  const modifieds = [];\n\n  const cloneKeys = keys.slice();\n  let target = _this.currentTarget;\n  while (cloneKeys.length) {\n    const targetKey = cloneKeys.shift();\n    if (target) {\n      target = target[targetKey];\n    }\n\n    modifieds.push(target);\n  }\n\n  return modifieds;\n};\n\nclass Watchers extends Array {\n  constructor(arr) {\n    super(...arr);\n  }\n\n  hasModified(key) {\n    return this.some((e) => e.hasModified(key));\n  }\n\n  hasReplaced(key) {\n    return this.some((e) => e.hasReplaced(key));\n  }\n}\n\nexport const emitUpdate = ({\n  type,\n  currentTarget,\n  target,\n  name,\n  value,\n  oldValue,\n  args,\n  path = [],\n}) => {\n  if (path && path.includes(currentTarget)) {\n    const err = getErr(\"circular_data\");\n\n    console.warn(err, {\n      currentTarget,\n      target,\n      path,\n    });\n\n    return;\n  }\n\n  let options = {\n    type,\n    target,\n    name,\n    oldValue,\n    value,\n  };\n\n  if (type === \"array\") {\n    delete options.value;\n    options.args = args;\n  }\n\n  if (currentTarget._hasWatchs) {\n    const watcher = new Watcher({\n      currentTarget,\n      ...options,\n      path: [...path],\n    });\n\n    currentTarget[WATCHS].forEach((func) => {\n      func(watcher);\n    });\n  }\n\n  currentTarget._update &&\n    currentTarget.owner.forEach((parent) => {\n      emitUpdate({\n        currentTarget: parent,\n        ...options,\n        path: [currentTarget, ...path],\n      });\n    });\n};\n\nexport default {\n  watch(callback) {\n    if (!(callback instanceof Function)) {\n      throw getErr(\"not_func\", { name: \"watch\" });\n    }\n\n    const wid = \"w-\" + getRandomId();\n\n    this[WATCHS].set(wid, callback);\n\n    return wid;\n  },\n\n  unwatch(wid) {\n    return this[WATCHS].delete(wid);\n  },\n\n  watchTick(callback, wait) {\n    if (!(callback instanceof Function)) {\n      throw getErr(\"not_func\", { name: \"watchTick\" });\n    }\n\n    return this.watch(\n      debounce((arr) => {\n        if (dataRevoked(this)) {\n          // console.warn(`The revoked object cannot use watchTick : `, this);\n          return;\n        }\n        arr = arr.filter((e) => {\n          try {\n            e.path.forEach((item) => item.xid);\n          } catch (err) {\n            return false;\n          }\n\n          return true;\n        });\n\n        callback(new Watchers(arr));\n      }, wait || 0)\n    );\n  },\n  // For manual use of emitUpdate\n  refresh(opts) {\n    const options = {\n      ...opts,\n      type: \"refresh\",\n      target: this,\n      currentTarget: this,\n    };\n    emitUpdate(options);\n  },\n  watchUntil(func, outTime = 30000) {\n    return new Promise((resolve, reject) => {\n      let f;\n      let timer;\n      const tid = this.watch(\n        (f = () => {\n          const bool = func();\n          if (bool) {\n            clearTimeout(timer);\n            this.unwatch(tid);\n            resolve(this);\n          }\n        })\n      );\n\n      timer = setTimeout(() => {\n        this.unwatch(tid);\n        const err = getErr(\"watchuntil_timeout\");\n        console.warn(err, func, this);\n        reject(err);\n      }, outTime);\n\n      f();\n    });\n  },\n};\n","import { isObject } from \"./public.mjs\";\nimport Stanz, { PROXY, isxdata } from \"./main.mjs\";\nimport { emitUpdate } from \"./watch.mjs\";\nimport { getErr } from \"../ofa-error/main.js\";\n\nconst { defineProperties } = Object;\n\nexport const setData = ({ target, key, value, receiver, type, succeed }) => {\n  const oldValue = receiver[key];\n\n  let data = value;\n  if (isxdata(data)) {\n    if (oldValue === value) {\n      return true;\n    }\n    data._owner.push(receiver);\n  } else if (isObject(value)) {\n    const desc = Object.getOwnPropertyDescriptor(target, key);\n    if (!desc || desc.hasOwnProperty(\"value\")) {\n      data = new (target.__OriginStanz || Stanz)(value, {\n        owner: receiver,\n      });\n\n      data._owner.push(receiver);\n    }\n  }\n\n  const isSame = oldValue === value;\n\n  if (!isSame && isxdata(oldValue)) {\n    clearOwner(oldValue, receiver);\n  }\n\n  const reval = succeed(data);\n\n  !isSame &&\n    // __unupdate: Let the system not trigger an upgrade, system self-use attribute\n    !target.__unupdate &&\n    emitUpdate({\n      type: type || \"set\",\n      target: receiver,\n      currentTarget: receiver,\n      name: key,\n      value,\n      oldValue,\n    });\n\n  return reval;\n};\n\n// 当数据被移除时，清除 owner 数据\nexport const clearOwner = (targetData, owner) => {\n  if (isxdata(targetData)) {\n    const index = targetData._owner.indexOf(owner);\n    if (index > -1) {\n      targetData._owner.splice(index, 1);\n    } else {\n      const err = getErr(\"error_no_owner\");\n      console.warn(err, {\n        owner,\n        mismatch: targetData,\n      });\n      console.error(err);\n    }\n  }\n};\n\nexport const handler = {\n  set(target, key, value, receiver) {\n    if (typeof key === \"symbol\") {\n      return Reflect.set(target, key, value, receiver);\n    }\n\n    // Set properties with _ prefix directly\n    if (/^_/.test(key)) {\n      if (!target.hasOwnProperty(key)) {\n        defineProperties(target, {\n          [key]: {\n            writable: true,\n            configurable: true,\n            value,\n          },\n        });\n      } else {\n        Reflect.set(target, key, value, receiver);\n      }\n      return true;\n    }\n\n    try {\n      return setData({\n        target,\n        key,\n        value,\n        receiver,\n        succeed(data) {\n          return Reflect.set(target, key, data, receiver);\n        },\n      });\n    } catch (error) {\n      const err = getErr(\n        \"failed_to_set_data\",\n        {\n          key,\n        },\n        error\n      );\n\n      console.warn(err, { target, value });\n\n      throw err;\n    }\n  },\n  deleteProperty(target, key) {\n    if (/^_/.test(key) || typeof key === \"symbol\") {\n      return Reflect.deleteProperty(target, key);\n    }\n\n    return setData({\n      target,\n      key,\n      value: undefined,\n      receiver: target[PROXY],\n      type: \"delete\",\n      succeed() {\n        return Reflect.deleteProperty(target, key);\n      },\n    });\n  },\n};\n","import { clearOwner } from \"./accessor.mjs\";\nimport { SELF, PROXY, isxdata } from \"./main.mjs\";\nimport { isObject } from \"./public.mjs\";\nimport { emitUpdate } from \"./watch.mjs\";\n\nconst mutatingMethods = [\n  \"push\",\n  \"pop\",\n  \"shift\",\n  \"unshift\",\n  \"splice\",\n  \"reverse\",\n  \"sort\",\n  \"fill\",\n  \"copyWithin\",\n];\n\nconst holder = Symbol(\"placeholder\");\n\nfunction compareArrays(oldArray, newArray) {\n  const backupNewArray = Array.from(newArray);\n  const backupOldArray = Array.from(oldArray);\n  const deletedItems = [];\n  const addedItems = new Map();\n\n  const oldLen = oldArray.length;\n  for (let i = 0; i < oldLen; i++) {\n    const oldItem = oldArray[i];\n    const newIndex = backupNewArray.indexOf(oldItem);\n    if (newIndex > -1) {\n      backupNewArray[newIndex] = holder;\n    } else {\n      deletedItems.push(oldItem);\n    }\n  }\n\n  const newLen = newArray.length;\n  for (let i = 0; i < newLen; i++) {\n    const newItem = newArray[i];\n    const oldIndex = backupOldArray.indexOf(newItem);\n    if (oldIndex > -1) {\n      backupOldArray[oldIndex] = holder;\n    } else {\n      addedItems.set(i, newItem);\n    }\n  }\n\n  return { deletedItems, addedItems };\n}\n\nconst fn = {};\n\nconst arrayFn = Array.prototype;\n\nmutatingMethods.forEach((methodName) => {\n  if (arrayFn[methodName]) {\n    fn[methodName] = function (...args) {\n      const backupArr = Array.from(this);\n\n      const reval = arrayFn[methodName].apply(this[SELF], args);\n\n      const { deletedItems, addedItems } = compareArrays(backupArr, this);\n\n      // Refactoring objects as proxy instances\n      for (let [key, value] of addedItems) {\n        if (isxdata(value)) {\n          value._owner.push(this);\n        } else if (isObject(value)) {\n          this.__unupdate = 1;\n          this[key] = value;\n          delete this.__unupdate;\n        }\n      }\n\n      for (let item of deletedItems) {\n        clearOwner(item, this);\n      }\n\n      emitUpdate({\n        type: \"array\",\n        currentTarget: this,\n        target: this,\n        args,\n        name: methodName,\n        oldValue: backupArr,\n      });\n\n      if (reval === this[SELF]) {\n        return this[PROXY];\n      }\n\n      return reval;\n    };\n  }\n});\n\n// Object.getOwnPropertyNames(Array.prototype).forEach((methodName) => {\n[\"concat\", \"filter\", \"slice\", \"flatMap\", \"map\"].forEach((methodName) => {\n  if (methodName === \"constructor\" || mutatingMethods.includes(methodName)) {\n    return;\n  }\n\n  const oldFunc = Array.prototype[methodName];\n  if (oldFunc instanceof Function) {\n    fn[methodName] = function (...args) {\n      return oldFunc.call(Array.from(this), ...args);\n    };\n  }\n});\n\nexport default fn;\n","import { extend, getRandomId } from \"./public.mjs\";\nimport { handler as stanzHandler } from \"./accessor.mjs\";\nimport arrayFn from \"./array.mjs\";\nimport watchFn from \"./watch.mjs\";\nimport { getErr } from \"../ofa-error/main.js\";\nconst { defineProperties, getOwnPropertyDescriptor, entries } = Object;\n\nexport const SELF = Symbol(\"self\");\nexport const PROXY = Symbol(\"proxy\");\nexport const WATCHS = Symbol(\"watchs\");\nexport const ISXDATA = Symbol(\"isxdata\");\n\nexport const isxdata = (val) => val && !!val[ISXDATA];\n\nexport function constructor(data, handler = stanzHandler) {\n  // const proxySelf = new Proxy(this, handler);\n  let { proxy: proxySelf, revoke } = Proxy.revocable(this, handler);\n\n  // Determines the properties of the listener bubble\n  proxySelf._update = 1;\n\n  let watchs;\n\n  defineProperties(this, {\n    xid: { value: data.xid || getRandomId() },\n    // Save all parent objects\n    _owner: {\n      value: [],\n    },\n    owner: {\n      configurable: true,\n      get() {\n        return new Set(this._owner);\n      },\n    },\n    [ISXDATA]: {\n      value: true,\n    },\n    [SELF]: {\n      configurable: true,\n      get: () => this,\n    },\n    [PROXY]: {\n      configurable: true,\n      get: () => proxySelf,\n    },\n    // Save the object of the listener function\n    [WATCHS]: {\n      get: () => watchs || (watchs = new Map()),\n    },\n    _hasWatchs: {\n      get: () => !!watchs,\n    },\n    _revoke: {\n      value: revoke,\n    },\n  });\n\n  Object.keys(data).forEach((key) => {\n    const descObj = getOwnPropertyDescriptor(data, key);\n    let { value, get, set } = descObj;\n\n    if (get || set) {\n      defineProperties(this, {\n        [key]: descObj,\n      });\n    } else {\n      // Set the function directly\n      proxySelf[key] = value;\n    }\n  });\n\n  return proxySelf;\n}\n\nexport default class Stanz extends Array {\n  constructor(data, options) {\n    // options是被继承的类库使用的参数，当前stanz不需要使用\n    super();\n\n    return constructor.call(this, data);\n  }\n\n  // This method is still in the experimental period\n  revoke() {\n    const self = this[SELF];\n\n    if (self._onrevokes) {\n      self._onrevokes.forEach((f) => f());\n      self._onrevokes.length = 0;\n    }\n\n    self.__unupdate = 1;\n\n    self[WATCHS].clear();\n\n    entries(this).forEach(([name, value]) => {\n      if (isxdata(value)) {\n        this[name] = null;\n      }\n    });\n\n    self._owner.forEach((parent) => {\n      entries(parent).forEach(([name, value]) => {\n        if (value === this) {\n          parent[name] = null;\n        }\n      });\n    });\n\n    delete self[SELF];\n    delete self[PROXY];\n    self._revoke();\n  }\n\n  toJSON() {\n    let obj = {};\n\n    let isPureArray = true;\n    let maxId = -1;\n\n    Object.keys(this).forEach((k) => {\n      let val = this[k];\n\n      if (!/\\D/.test(k)) {\n        k = parseInt(k);\n        if (k > maxId) {\n          maxId = k;\n        }\n      } else {\n        isPureArray = false;\n      }\n\n      if (isxdata(val)) {\n        val = val.toJSON();\n      }\n\n      obj[k] = val;\n    });\n\n    if (isPureArray) {\n      obj.length = maxId + 1;\n      obj = Array.from(obj);\n    }\n\n    const xid = this.xid;\n    defineProperties(obj, {\n      xid: {\n        get: () => xid,\n      },\n    });\n\n    return obj;\n  }\n\n  toString() {\n    return JSON.stringify(this.toJSON());\n  }\n\n  extend(obj, desc) {\n    return extend(this, obj, desc);\n  }\n\n  get(key) {\n    if (/\\./.test(key)) {\n      const keys = key.split(\".\");\n      let target = this;\n      for (let i = 0, len = keys.length; i < len; i++) {\n        try {\n          target = target[keys[i]];\n        } catch (error) {\n          const err = getErr(\n            \"failed_to_get_data\",\n            {\n              key: keys.slice(0, i).join(\".\"),\n            },\n            error\n          );\n\n          console.warn(err, {\n            key,\n            self: this,\n          });\n\n          throw err;\n        }\n      }\n\n      return target;\n    }\n\n    return this[key];\n  }\n  set(key, value) {\n    if (/\\./.test(key)) {\n      const keys = key.split(\".\");\n      const lastKey = keys.pop();\n      let target = this;\n      for (let i = 0, len = keys.length; i < len; i++) {\n        try {\n          target = target[keys[i]];\n        } catch (error) {\n          const err = getErr(\n            \"failed_to_get_data\",\n            {\n              key: keys.slice(0, i).join(\".\"),\n            },\n            error\n          );\n\n          console.warn(err, {\n            key,\n            self: this,\n          });\n\n          throw err;\n        }\n      }\n\n      return (target[lastKey] = value);\n    }\n\n    return (this[key] = value);\n  }\n}\n\nStanz.prototype.extend(\n  { ...watchFn, ...arrayFn },\n  {\n    enumerable: false,\n  }\n);\n","import Stanz, { isxdata } from \"./main.mjs\";\n\nconst stanz = (data) => {\n  return new Stanz(data);\n};\n\nObject.assign(stanz, { is: isxdata });\n\nexport default stanz;\n\nexport { stanz, Stanz };\n"],"names":["error_origin","errors","globalThis","navigator","language","langFirst","toLowerCase","split","localStorage","targetLangErrors","JSON","parse","Object","assign","errCacheTime","Date","now","Number","fetch","then","e","json","catch","stringify","error","console","isSafari","userAgent","includes","getErr","key","options","errObj","desc","getErrDesc","toString","stack","replace","Error","cause","code","k","RegExp","getRandomId","Math","random","slice","objectToString","prototype","isObject","obj","type","value","call","afterTimer","asyncsCounter","debounce","func","wait","timeout","hisArgs","args","callback","push","clearTimeout","setTimeout","this","Promise","resolve","err","warn","freeze","Watcher","constructor","opts","hasModified","path","currentTarget","get","keys","target","name","positionIndex","getModifieds","indexOf","currentKeys","length","hasReplaced","_this","modifieds","cloneKeys","targetKey","shift","Watchers","Array","arr","super","some","emitUpdate","oldValue","_hasWatchs","watcher","WATCHS","forEach","_update","owner","parent","watchFn","watch","Function","wid","set","unwatch","delete","watchTick","proxyToCheck","getPrototypeOf","TypeError","dataRevoked","filter","item","xid","refresh","watchUntil","outTime","reject","f","timer","tid","defineProperties","setData","receiver","succeed","data","isxdata","_owner","getOwnPropertyDescriptor","hasOwnProperty","__OriginStanz","Stanz","isSame","clearOwner","reval","__unupdate","targetData","index","splice","mismatch","handler","Reflect","test","writable","configurable","deleteProperty","undefined","PROXY","mutatingMethods","holder","Symbol","fn","arrayFn","methodName","backupArr","from","apply","SELF","deletedItems","addedItems","oldArray","newArray","backupNewArray","backupOldArray","Map","oldLen","i","oldItem","newIndex","newLen","newItem","oldIndex","compareArrays","oldFunc","entries","ISXDATA","val","stanzHandler","watchs","proxy","proxySelf","revoke","Proxy","revocable","Set","_revoke","descObj","self","_onrevokes","clear","toJSON","isPureArray","maxId","parseInt","extend","proto","descriptor","getOwnPropertyNames","getOwnPropertySymbols","result","enumerable","defineProperty","len","join","lastKey","pop","stanz","is"],"mappings":"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"}